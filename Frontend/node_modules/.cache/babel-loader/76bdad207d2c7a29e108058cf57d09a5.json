{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/user/Desktop/web development/Lessons + Homework/Third Project/Fullstack/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"C:/Users/user/Desktop/web development/Lessons + Homework/Third Project/Fullstack/Frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/user/Desktop/web development/Lessons + Homework/Third Project/Fullstack/Frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\user\\\\Desktop\\\\web development\\\\Lessons + Homework\\\\Third Project\\\\Fullstack\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{AuthState}from'./../Redux/AuthState';import{vacationsStore}from'./../Redux/Store';import{addVacationAction,deleteVacationAction,fetchVacationsAction,updateVacationAction}from'./../Redux/VacationsState';import config from'../Utils/config';import axios from'axios';var VacationsService=/*#__PURE__*/function(){function VacationsService(){_classCallCheck(this,VacationsService);}_createClass(VacationsService,[{key:\"getAllVacations\",value:function(){var _getAllVacations=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var loggedUser,response,vacations;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(vacationsStore.getState().vacations.length===0)){_context.next=8;break;}loggedUser=new AuthState();_context.next=4;return axios.get(config.urls.vacationsByUser+loggedUser.user.id);case 4:response=_context.sent;vacations=response.data;vacationsStore.dispatch(fetchVacationsAction(vacations));return _context.abrupt(\"return\",vacations);case 8:return _context.abrupt(\"return\",vacationsStore.getState().vacations);case 9:case\"end\":return _context.stop();}}},_callee);}));function getAllVacations(){return _getAllVacations.apply(this,arguments);}return getAllVacations;}()},{key:\"getOneVacation\",value:function(){var _getOneVacation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(vacationId){var vacations,vacation,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:vacations=vacationsStore.getState().vacations;vacation=vacations.find(function(v){return v.vacationId===vacationId;});if(!vacation){_context2.next=4;break;}return _context2.abrupt(\"return\",vacation);case 4:_context2.next=6;return axios.get(config.urls.vacations+vacationId);case 6:response=_context2.sent;return _context2.abrupt(\"return\",response.data);case 8:case\"end\":return _context2.stop();}}},_callee2);}));function getOneVacation(_x){return _getOneVacation.apply(this,arguments);}return getOneVacation;}()},{key:\"addVacation\",value:function(){var _addVacation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(vacation){var myFormData,response,addedVacation;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:myFormData=new FormData();myFormData.append(\"description\",vacation.description);myFormData.append(\"destination\",vacation.destination);myFormData.append(\"startingDate\",vacation.startingDate.toString());myFormData.append(\"endingDate\",vacation.endingDate.toString());myFormData.append(\"price\",vacation.price.toString());myFormData.append(\"image\",vacation.image.item(0));_context3.next=9;return axios.post(config.urls.vacations,myFormData);case 9:response=_context3.sent;addedVacation=response.data;vacationsStore.dispatch(addVacationAction(addedVacation));return _context3.abrupt(\"return\",addedVacation);case 13:case\"end\":return _context3.stop();}}},_callee3);}));function addVacation(_x2){return _addVacation.apply(this,arguments);}return addVacation;}()},{key:\"updateVacation\",value:function(){var _updateVacation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(vacation){var myFormData,response,updatedVacation;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:myFormData=new FormData();myFormData.append(\"description\",vacation.description);myFormData.append(\"destination\",vacation.destination);myFormData.append(\"startingDate\",vacation.startingDate);myFormData.append(\"endingDate\",vacation.endingDate);myFormData.append(\"price\",vacation.price.toString());myFormData.append(\"followersCount\",vacation.followersCount.toString());myFormData.append(\"image\",vacation.image.item(0));_context4.next=10;return axios.put(config.urls.vacations+vacation.vacationId,myFormData);case 10:response=_context4.sent;updatedVacation=response.data;vacationsStore.dispatch(updateVacationAction(updatedVacation));return _context4.abrupt(\"return\",updatedVacation);case 14:case\"end\":return _context4.stop();}}},_callee4);}));function updateVacation(_x3){return _updateVacation.apply(this,arguments);}return updateVacation;}()},{key:\"deleteVacation\",value:function(){var _deleteVacation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(vacationId){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return axios.delete(config.urls.vacations+vacationId);case 2:vacationsStore.dispatch(deleteVacationAction(vacationId));case 3:case\"end\":return _context5.stop();}}},_callee5);}));function deleteVacation(_x4){return _deleteVacation.apply(this,arguments);}return deleteVacation;}()},{key:\"addFollower\",value:function(){var _addFollower=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(vacationId,userId){var response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return axios.post(config.urls.follow+vacationId.toString()+\"/\"+userId.toString());case 2:response=_context6.sent;return _context6.abrupt(\"return\",response.data);case 4:case\"end\":return _context6.stop();}}},_callee6);}));function addFollower(_x5,_x6){return _addFollower.apply(this,arguments);}return addFollower;}()},{key:\"isFollowing\",value:function(){var _isFollowing=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(vacationId,userId){var response;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return axios.get(config.urls.follow+vacationId.toString()+\"/\"+userId.toString());case 2:response=_context7.sent;return _context7.abrupt(\"return\",response.data);case 4:case\"end\":return _context7.stop();}}},_callee7);}));function isFollowing(_x7,_x8){return _isFollowing.apply(this,arguments);}return isFollowing;}()}]);return VacationsService;}();var vacationsService=new VacationsService();export default vacationsService;","map":{"version":3,"sources":["C:/Users/user/Desktop/web development/Lessons + Homework/Third Project/Fullstack/Frontend/src/Services/VacationsService.ts"],"names":["AuthState","vacationsStore","addVacationAction","deleteVacationAction","fetchVacationsAction","updateVacationAction","config","axios","VacationsService","getState","vacations","length","loggedUser","get","urls","vacationsByUser","user","id","response","data","dispatch","vacationId","vacation","find","v","myFormData","FormData","append","description","destination","startingDate","toString","endingDate","price","image","item","post","addedVacation","followersCount","put","updatedVacation","delete","userId","follow","vacationsService"],"mappings":"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","sourcesContent":["import { AuthState } from './../Redux/AuthState';\r\nimport { vacationsStore } from './../Redux/Store';\r\nimport { addVacationAction, deleteVacationAction, fetchVacationsAction, updateVacationAction } from './../Redux/VacationsState';\r\nimport VacationModel from \"../Models/VacationModel\";\r\nimport config from '../Utils/config';\r\nimport axios from 'axios';\r\n\r\nclass VacationsService {\r\n    public async getAllVacations(): Promise<VacationModel[]>{\r\n\r\n        if(vacationsStore.getState().vacations.length === 0) {\r\n            const loggedUser = new AuthState()            \r\n            const response = await axios.get<VacationModel[]>(config.urls.vacationsByUser + loggedUser.user.id);\r\n            const vacations = response.data;   \r\n            vacationsStore.dispatch(fetchVacationsAction(vacations));\r\n            return vacations;\r\n        }\r\n\r\n        return vacationsStore.getState().vacations;\r\n    }\r\n\r\n    public async getOneVacation(vacationId: number): Promise<VacationModel> {\r\n        const vacations = vacationsStore.getState().vacations;\r\n        const vacation = vacations.find(v => v.vacationId === vacationId);\r\n        if(vacation)  return vacation;\r\n\r\n        const response = await axios.get<VacationModel>(config.urls.vacations + vacationId);\r\n        return response.data;\r\n    }\r\n\r\n    public async addVacation(vacation: VacationModel): Promise<VacationModel> {\r\n        const myFormData = new FormData();\r\n        myFormData.append(\"description\", vacation.description);\r\n        myFormData.append(\"destination\", vacation.destination);\r\n        myFormData.append(\"startingDate\", vacation.startingDate.toString());\r\n        myFormData.append(\"endingDate\", vacation.endingDate.toString());\r\n        myFormData.append(\"price\", vacation.price.toString());\r\n        myFormData.append(\"image\", vacation.image.item(0));        \r\n        const response = await axios.post<VacationModel>(config.urls.vacations, myFormData);\r\n        const addedVacation = response.data;\r\n        vacationsStore.dispatch(addVacationAction(addedVacation));\r\n        return addedVacation;\r\n    }\r\n\r\n    public async updateVacation(vacation: VacationModel): Promise<VacationModel> {\r\n        const myFormData = new FormData();\r\n        myFormData.append(\"description\", vacation.description);\r\n        myFormData.append(\"destination\", vacation.destination);\r\n        myFormData.append(\"startingDate\", vacation.startingDate);\r\n        myFormData.append(\"endingDate\", vacation.endingDate);\r\n        myFormData.append(\"price\", vacation.price.toString());\r\n        myFormData.append(\"followersCount\", vacation.followersCount.toString());\r\n        myFormData.append(\"image\", vacation.image.item(0));\r\n        const response = await axios.put<VacationModel>(config.urls.vacations + vacation.vacationId, myFormData);\r\n        const updatedVacation = response.data;\r\n        vacationsStore.dispatch(updateVacationAction(updatedVacation));\r\n        return updatedVacation;\r\n    }\r\n\r\n    public async deleteVacation(vacationId: number): Promise<void> {\r\n        await axios.delete<VacationModel>(config.urls.vacations + vacationId);\r\n        vacationsStore.dispatch(deleteVacationAction(vacationId));\r\n\r\n    }\r\n\r\n    public async addFollower(vacationId: number, userId: number): Promise<boolean> {\r\n        const response = await axios.post<boolean>(config.urls.follow + vacationId.toString() + \"/\" + userId.toString());        \r\n        return response.data;\r\n    }\r\n\r\n    public async isFollowing(vacationId: number, userId: number): Promise<boolean>{\r\n        const response = await axios.get<boolean>(config.urls.follow + vacationId.toString() + \"/\" + userId.toString());\r\n        return response.data;\r\n    }\r\n\r\n}\r\nconst vacationsService = new VacationsService();\r\nexport default vacationsService;\r\n\r\n"]},"metadata":{},"sourceType":"module"}